<%# app/views/cart_products/_cart_product_row.html.erb %>
<%# La variable local es 'item' (un CartProduct) %>

<%# ID CRÍTICO: Usamos el ID del CartProduct (item.id) para referenciar la fila %>
<tr id="cart_item_<%= item.id %>"> 
  <td>
    <h5 class="my-0"><%= item.product.name %></h5>
    <small class="text-muted"><%= truncate(item.product.description, length: 40) %></small>
  </td>
  
  <td class="text-center">
    <div class="btn-group btn-group-sm" role="group">
      <%# Botón - : Usa el ID del Producto para la ruta, pero necesitamos actualizar la fila con el ID del CartProduct %>
      <%= button_to "-", 
                    remove_from_cart_path(id: item.product.id), 
                    method: :post, 
                    class: "btn btn-outline-secondary", 
                    data: { turbo_stream: true } %>
                    
      <span class="btn btn-light border"><%= item.quantity %></span>
      
      <%# Botón + %>
      <%= button_to "+", 
                    add_to_cart_path(id: item.product.id), 
                    method: :post, 
                    class: "btn btn-outline-secondary", 
                    data: { turbo_stream: true } %>
    </div>
  </td>
  
  <td class="text-end"><%= number_to_currency(item.product_price) %></td>
  
  <td class="text-end fw-bold"><%= number_to_currency(item.product_price * item.quantity) %></td>
</tr>