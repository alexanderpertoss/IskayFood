<div class="container my-5">
  <h2 class="mb-4 text-center font-staatliches section-title1-primary">Clients Portfolio</h2>

  <%# Navegación del Dashboard %>
  <div class="d-flex flex-wrap justify-content-center gap-2 mb-4">
    <%= link_to 'Orders', orders_path, class: 'btn btn-primary-custom font-staatliches' %>
    <%= link_to 'Products', products_path, class: 'btn btn-primary-custom font-staatliches' %>
    <%= link_to 'Bookings', bookings_list_path, class: 'btn btn-primary-custom font-staatliches' %>
    <%= link_to 'Messages', contacts_path, class: 'btn btn-primary-custom font-staatliches' %>
    <%= link_to 'Reviews', reviews_path, class: 'btn btn-primary-custom font-staatliches' %>
    <%= link_to 'Clients', clients_path, class: 'btn btn-primary-custom font-staatliches active' %>
    <%= link_to 'Services', services_path, class: 'btn btn-primary-custom font-staatliches' %>
    <%= link_to 'Stripe Dashboard', "https://dashboard.stripe.com/", class: 'btn btn-primary-custom font-staatliches', target: "_blank" %>
  </div>

  <% if notice.present? %>
    <div class="alert alert-success font-staatliches text-center shadow-sm"><%= notice %></div>
  <% end %>

  <% if @clients.any? %>
    <div class="table-responsive shadow-sm rounded">
      <table class="table table-hover table-striped table-bordered align-middle mb-0">
        <thead class="table-dark font-staatliches text-center">
          <tr>
            <th scope="col" style="width: 80px;">#</th>
            <th scope="col" style="width: 120px;">Logo / Photo</th>
            <th scope="col">Client Name</th>
            <th scope="col" style="width: 200px;">Options</th>
          </tr>
        </thead>
        <tbody class="font-staatliches">
          <% @clients.each_with_index do |client, index| %>
            <tr>
              <th scope="row" class="text-center text-muted"><%= index + 1 %></th>
              
              <%# Columna de Imágenes %>
              <td class="text-center">
                <% if client.images.attached? %>
                  <%# Mostramos solo la primera imagen como miniatura %>
                  <%= image_tag client.images.first, class: "img-thumbnail", 
                                style: "width: 70px; height: 70px; object-fit: cover; border-radius: 8px;" %>
                  <% if client.images.count > 1 %>
                    <div class="small text-muted">+<%= client.images.count - 1 %> more</div>
                  <% end %>
                <% else %>
                  <div class="bg-light d-flex align-items-center justify-content-center mx-auto" 
                       style="width: 70px; height: 70px; border: 1px dashed #ccc; border-radius: 8px;">
                    <i class="bi bi-person-bounding-box text-muted"></i>
                  </div>
                <% end %>
              </td>

              <td class="ps-4 fw-bold text-uppercase"><%= client.name %></td>

              <td class="text-center">
                <div class="d-flex justify-content-center gap-2">
                  <%# link_to "View", client, class: "btn btn-info btn-sm text-white px-3" %>
                  <%= link_to "Edit", edit_client_path(client), class: "btn btn-warning btn-sm px-3" %>
                  <%= link_to "Delete", client, data: { turbo_method: :delete, turbo_confirm: "Are you sure?" }, class: "btn btn-danger btn-sm" %>
                </div>
              </td>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>
  <% else %>
    <div class="alert alert-info text-center mt-4" role="alert">
      No clients registered in the portfolio.
    </div>
  <% end %>

  <div class="text-center mt-5">
    <%= link_to "Add New Client", new_client_path, class: "btn btn-success btn-lg font-staatliches px-5 shadow" %>
  </div>
</div>